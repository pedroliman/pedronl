---
title: Factory Physics Flow Benchmarking in R
author: Pedro N. de Lima
date: '2019-04-22'
slug: factory-physics-flow-benchmarking-in-r
categories:
  - R Blogs
  - R
tags:
  - R
  - Simulation
header:
  caption: ''
  image: ''
bibliography: [references/references-metamodeling.bib]
link-citations: true
---



<p><a href="https://factoryphysics.com/flow-benchmarking">Factory Physics (FP) Flow Benchmarking</a> is a technique useful to perform absolute benchmark of a system’s throughput and cycle time, given the Work in Process (wip) the system is allowed to have. These techniques are introduced in <span class="citation">(Pound, Bell, and Spearman <a href="#ref-pound2014factory">2014</a>)</span> and <span class="citation">(Hopp and Spearman <a href="#ref-hopp2008factory">2008</a>)</span>, and repeating this discussion is beyond the scope of this post.</p>
<p>As a simulation pratictioneer and lecturer, as I read these books, I naturally started creating models and spreadsheet formulas to verify if the theory holds (and, of course, it does). After reading the book, I found my self wondering: “How do I teach these things? If I were to teach my students to perform Flow Benchmarking, what would this class require?”</p>
<p>This post offers my answer to this question using <a href="https://www.r-project.org/">R</a>. Naturally, this post will be usefull to those willing to use their Simulation models to perform flow benchmarking as prescribed in <span class="citation">(Pound, Bell, and Spearman <a href="#ref-pound2014factory">2014</a>)</span>.</p>
<div id="defining-fp-laws" class="section level2">
<h2>Defining FP Laws</h2>
<p>The FP book defines a set of equations which serve as absolute benchmarks for any manufacturing systems <span class="citation">(Hopp and Spearman <a href="#ref-hopp2008factory">2008</a>)</span>. These equations define the maximum Throughput and minimum Cycle Times a manufacturing system can have, given its work in process (wip), bottleneck rate (rb) and the sum of the mean processing times of all stations (t0), assuming that the system is using a CONWIP system <span class="citation">(SPEARMAN, WOODRUFF, and HOPP <a href="#ref-Spearman1990">1990</a>)</span>.</p>
<p>First, then, I’ll create these equations as R functions, which will be useful later.</p>
<pre class="r"><code>calc_w0 = function(rb, t0) {rb * t0}

ct_best = function(t0, w, w0, rb) {ifelse(w&lt;=w0,t0,w/rb)}

th_best = function(t0, w, w0, rb) {ifelse(w&lt;=w0,w/t0,rb)}

ct_worst = function(w,t0){w*t0}

th_worst = function(t0){1/t0}

ct_marginal = function(t0,w,rb){t0+(w-1)/rb}

th_marginal = function(w0,w,rb){rb*w/(w0+w-1)}</code></pre>
<p>A</p>
<pre class="r"><code>## Defining Cycle time and Throughput functions

benchmark_flow = function(rb, t0, step = 1, wip_mult = 5) {
  
  # First, calculate wip_crit
  w0 = calc_w0(rb = rb, t0 = t0)
  
  # Then, define WIP Range to consider:
  
  wip = seq.int(from = 1, to = w0 * wip_mult, by = step)
  
  # Then, calculate The Best Case Variables
  Best_Cycle_Time = ct_best(t0 = t0, w = wip, w0 = w0, rb = rb)
  Best_ThroughPut = th_best(t0 = t0, w = wip, w0 = w0, rb = rb)
  
  best_data = data.frame(WIP = wip,
                    ThroughPut = Best_ThroughPut,
                    CycleTime = Best_Cycle_Time,
                    Scenario = &quot;Best&quot;)
  
  # Calculate the Marginal Cases:
  Marginal_Cycle_Time = ct_marginal(t0=t0,w=wip,rb=rb)
  Marginal_ThroughPut = th_marginal(w0=w0,w=wip,rb=rb)
  
  marginal_data = data.frame(WIP = wip,
                    ThroughPut = Marginal_ThroughPut,
                    CycleTime = Marginal_Cycle_Time,
                    Scenario = &quot;Marginal&quot;)

  # Output A DataFrame with results:
  rbind(best_data, marginal_data)
  
}

# Perform a BenchMarch of the First Penny Fab:
data_benchmark = benchmark_flow(rb = 0.5, t0 = 8)

data_benchmark</code></pre>
<pre><code>##    WIP ThroughPut CycleTime Scenario
## 1    1  0.1250000         8     Best
## 2    2  0.2500000         8     Best
## 3    3  0.3750000         8     Best
## 4    4  0.5000000         8     Best
## 5    5  0.5000000        10     Best
## 6    6  0.5000000        12     Best
## 7    7  0.5000000        14     Best
## 8    8  0.5000000        16     Best
## 9    9  0.5000000        18     Best
## 10  10  0.5000000        20     Best
## 11  11  0.5000000        22     Best
## 12  12  0.5000000        24     Best
## 13  13  0.5000000        26     Best
## 14  14  0.5000000        28     Best
## 15  15  0.5000000        30     Best
## 16  16  0.5000000        32     Best
## 17  17  0.5000000        34     Best
## 18  18  0.5000000        36     Best
## 19  19  0.5000000        38     Best
## 20  20  0.5000000        40     Best
## 21   1  0.1250000         8 Marginal
## 22   2  0.2000000        10 Marginal
## 23   3  0.2500000        12 Marginal
## 24   4  0.2857143        14 Marginal
## 25   5  0.3125000        16 Marginal
## 26   6  0.3333333        18 Marginal
## 27   7  0.3500000        20 Marginal
## 28   8  0.3636364        22 Marginal
## 29   9  0.3750000        24 Marginal
## 30  10  0.3846154        26 Marginal
## 31  11  0.3928571        28 Marginal
## 32  12  0.4000000        30 Marginal
## 33  13  0.4062500        32 Marginal
## 34  14  0.4117647        34 Marginal
## 35  15  0.4166667        36 Marginal
## 36  16  0.4210526        38 Marginal
## 37  17  0.4250000        40 Marginal
## 38  18  0.4285714        42 Marginal
## 39  19  0.4318182        44 Marginal
## 40  20  0.4347826        46 Marginal</code></pre>
<p>Then let’s plot!</p>
<pre class="r"><code>library(tidyr)
library(ggplot2)

# Lets define a wrapper function to our plot:

plot_benchmarking = function(data) {
  data %&gt;%
    gather(-WIP, -Scenario, key = &quot;var&quot;, value = &quot;Value&quot;) %&gt;%
  ggplot(aes(x = WIP, y = Value, color = Scenario)) +
    geom_line() +
    facet_wrap(~ var, scales = &quot;free&quot;) +
    labs(title = &quot;FP Flow Benchmarking Plot&quot;) +
    theme_bw()
}

# Then let&#39;s just benchmark and plot!

plot_benchmarking(data = benchmark_flow(rb = 0.5, t0 = 8, wip_mult = 10))</code></pre>
<p><img src="/post/2019-04-22-factory-physics-flow-benchmarking-with-arena-and-r_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>After plotting the benchmark curves, one can have productive discussion about what kinds of improvements are likely to produce good results.</p>
<p>Now its your turn. Copy and paste the R code, and insert the rb parameter (bottleneck rate), and t0 ()</p>
<p>The beauty of this analysis is that now you can pin point where any manufacturing system is in terms of WIP, Cycle Time and Throughput, and have a productive discussion about how to improve it.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-hopp2008factory">
<p>Hopp, W.J., and M.L. Spearman. 2008. <em>Factory Physics</em>. Irwin/Mcgraw-Hill Series in Operations and Decision Sciences. McGraw-Hill. <a href="https://books.google.com.br/books?id=tEjkAAAACAAJ">https://books.google.com.br/books?id=tEjkAAAACAAJ</a>.</p>
</div>
<div id="ref-pound2014factory">
<p>Pound, E.S., J.H. Bell, and M.L. Spearman. 2014. <em>Factory Physics for Managers: How Leaders Improve Performance in a Post-Lean Six Sigma World</em>. McGraw-Hill Education. <a href="https://books.google.com.br/books?id=B5sXAwAAQBAJ">https://books.google.com.br/books?id=B5sXAwAAQBAJ</a>.</p>
</div>
<div id="ref-Spearman1990">
<p>SPEARMAN, MARK L., DAVID L. WOODRUFF, and WALLACE J. HOPP. 1990. “CONWIP: A Pull Alternative to Kanban.” <em>International Journal of Production Research</em> 28 (5). Taylor &amp; Francis: 879–94. <a href="https://doi.org/10.1080/00207549008942761">https://doi.org/10.1080/00207549008942761</a>.</p>
</div>
</div>
</div>
